{"ast":null,"code":"import _regeneratorRuntime from\"/mnt/c/Users/82107/Desktop/study/3-2/\\uC6F9\\uC2DC\\uC124/\\uD504\\uB85C\\uC81D\\uD2B8/Dream_Search/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/mnt/c/Users/82107/Desktop/study/3-2/\\uC6F9\\uC2DC\\uC124/\\uD504\\uB85C\\uC81D\\uD2B8/Dream_Search/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/mnt/c/Users/82107/Desktop/study/3-2/\\uC6F9\\uC2DC\\uC124/\\uD504\\uB85C\\uC81D\\uD2B8/Dream_Search/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState,useEffect}from'react';import request,{setUserArticle}from'../libs/request';import{useLocation,withRouter}from'react-router-dom';import ArticleS from'../components/ArticleS';import CommentList from'../components/CommentList';import CommentForm from'../components/CommentForm';var ArticleSpecific=function ArticleSpecific(props){var location=useLocation();var _useState=useState(location.state),_useState2=_slicedToArray(_useState,1),article=_useState2[0];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),comments=_useState6[0],setComments=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),like=_useState8[0],setLike=_useState8[1];useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var tmp,temp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return request.getUser(window.sessionStorage.getItem('n_name'));case 2:tmp=_context.sent;setUser(tmp);_context.next=6;return request.getComments(location.state._id);case 6:temp=_context.sent;setComments(temp);case 8:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[]);useEffect(function(){function fetchData(){return _fetchData2.apply(this,arguments);}function _fetchData2(){_fetchData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _user$likes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.t0=setLike;_context2.next=3;return user===null||user===void 0?void 0:(_user$likes=user.likes)===null||_user$likes===void 0?void 0:_user$likes.find(function(id){return id===article._id;});case 3:_context2.t1=_context2.sent;_context2.t2=-1;if(!(_context2.t1>_context2.t2)){_context2.next=9;break;}_context2.t3=true;_context2.next=10;break;case 9:_context2.t3=false;case 10:_context2.t4=_context2.t3;(0,_context2.t0)(_context2.t4);case 12:case\"end\":return _context2.stop();}}},_callee2);}));return _fetchData2.apply(this,arguments);}fetchData();},[user]);var del=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return request.deleteArticle(article._id);case 2:window.alert('삭제되었습니다!');props.history.push('/');case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function del(){return _ref.apply(this,arguments);};}();var doLike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var formData;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:formData={user_id:user._id,article_id:article._id};_context4.next=3;return request.likeArticle(formData);case 3:setLike(true);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function doLike(){return _ref2.apply(this,arguments);};}();var doNotLike=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var formData;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:formData={user_id:user._id,article_id:article._id};_context5.next=3;return request.unlikeArticle(formData);case 3:setLike(false);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function doNotLike(){return _ref3.apply(this,arguments);};}();var setHead=function(){props.headerSet(article);}();var eventHandle=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var temp;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return request.getComments(location.state._id);case 2:temp=_context6.sent;setComments(temp);case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function eventHandle(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{class:\"container\",children:/*#__PURE__*/_jsx(\"div\",{class:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"col-lg-8 col-md-10 mx-auto\",children:[/*#__PURE__*/_jsx(ArticleS,{article:article,onDelete:del,user:user,like:like,doLike:doLike,doNotLike:doNotLike}),/*#__PURE__*/_jsxs(\"div\",{class:\"card card-outline-secondary my-4\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"card-header\",children:\"Comments\"}),/*#__PURE__*/_jsx(\"div\",{class:\"card-body\",children:/*#__PURE__*/_jsx(CommentList,{comments:comments})})]}),/*#__PURE__*/_jsx(CommentForm,{article:article,onSubmit:request.postComment,onHandle:function onHandle(){return eventHandle();}})]})})});};export default withRouter(ArticleSpecific);","map":{"version":3,"sources":["/mnt/c/Users/82107/Desktop/study/3-2/웹시설/프로젝트/Dream_Search/frontend/src/pages/ArticleSpecific.js"],"names":["React","useState","useEffect","request","setUserArticle","useLocation","withRouter","ArticleS","CommentList","CommentForm","ArticleSpecific","props","location","state","article","user","setUser","comments","setComments","like","setLike","fetchData","getUser","window","sessionStorage","getItem","tmp","getComments","_id","temp","likes","find","id","del","deleteArticle","alert","history","push","doLike","formData","user_id","article_id","likeArticle","doNotLike","unlikeArticle","setHead","headerSet","eventHandle","postComment"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport request, { setUserArticle } from '../libs/request'\r\nimport { useLocation, withRouter } from 'react-router-dom'\r\nimport ArticleS from '../components/ArticleS'\r\nimport CommentList from '../components/CommentList'\r\nimport CommentForm from '../components/CommentForm'\r\n\r\nconst ArticleSpecific = (props) => {\r\n    const location = useLocation();\r\n    const [article] = useState(location.state);\r\n    const [user, setUser] = useState();\r\n    const [comments, setComments] = useState();\r\n    const [like, setLike] = useState();\r\n\r\n    useEffect(() => {\r\n        async function fetchData() {\r\n            let tmp = await request.getUser(window.sessionStorage.getItem('n_name'));\r\n            setUser(tmp);\r\n            let temp = await request.getComments(location.state._id);\r\n            setComments(temp);\r\n        }\r\n        fetchData();\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        async function fetchData() {\r\n            setLike(await user?.likes?.find(id => id === article._id)>-1 ? true : false);\r\n        }\r\n        fetchData();\r\n    }, [user])\r\n\r\n    const del = async () => {\r\n        await request.deleteArticle(article._id);\r\n\r\n        window.alert('삭제되었습니다!');\r\n        props.history.push('/');\r\n    }\r\n\r\n    const doLike = async () => {\r\n        const formData={\r\n            user_id: user._id,\r\n            article_id: article._id\r\n        }\r\n        await request.likeArticle(formData);\r\n        setLike(true);\r\n    }\r\n\r\n    const doNotLike = async () => {\r\n        const formData={\r\n            user_id: user._id,\r\n            article_id: article._id\r\n        }\r\n        await request.unlikeArticle(formData);\r\n        setLike(false);\r\n    }\r\n\r\n    const setHead = (() => {\r\n        props.headerSet(article);\r\n    })();\r\n\r\n    const eventHandle = async () => {\r\n        let temp = await request.getComments(location.state._id);\r\n        setComments(temp);\r\n    }\r\n\r\n    return (\r\n        <div class=\"container\">\r\n            <div class=\"row\">\r\n\r\n                <div class=\"col-lg-8 col-md-10 mx-auto\">\r\n\r\n                    <ArticleS article={article} onDelete={del} user={user} like={like} doLike={doLike} doNotLike={doNotLike} />\r\n                    <div class=\"card card-outline-secondary my-4\">\r\n                        <div class=\"card-header\">\r\n                            Comments\r\n                        </div>\r\n                        <div class=\"card-body\">\r\n                            <CommentList comments={comments} />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <CommentForm article={article} onSubmit={request.postComment} onHandle={() => eventHandle()} />\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default withRouter(ArticleSpecific);"]},"metadata":{},"sourceType":"module"}