{"ast":null,"code":"import _regeneratorRuntime from\"/mnt/c/Users/82107/Desktop/study/3-2/\\uC6F9\\uC2DC\\uC124/\\uD504\\uB85C\\uC81D\\uD2B8/Dream_Search/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/mnt/c/Users/82107/Desktop/study/3-2/\\uC6F9\\uC2DC\\uC124/\\uD504\\uB85C\\uC81D\\uD2B8/Dream_Search/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/mnt/c/Users/82107/Desktop/study/3-2/\\uC6F9\\uC2DC\\uC124/\\uD504\\uB85C\\uC81D\\uD2B8/Dream_Search/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useRef,useState}from'react';import Star from'./Star';import{withRouter}from'react-router-dom';var CommentForm=function CommentForm(props){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),idx=_useState2[0],setIdx=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),rating=_useState4[0],setRating=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),cacheIdx=_useState6[0],setCacheIdx=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),cacheRating=_useState8[0],setCacheRating=_useState8[1];var content=useRef();var _mouseOver=function _mouseOver(e,i){e.persist();var offsetX=e.nativeEvent.offsetX;var clientX=e.target.clientWidth;if(offsetX>clientX/2){var value=2;setIdx(i);setRating(value);}else{var _value=1;setIdx(i);setRating(_value);}};var handleChange=function handleChange(i,v){setIdx(0);setRating(0);setCacheIdx(i);setCacheRating(v);};var resetComment=function resetComment(){setCacheIdx(0);setCacheRating(0);content.current.value='';};var submit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var comment,formData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(window.sessionStorage.getItem('n_name')){_context.next=5;break;}window.alert('로그인이 필요합니다!');props.history.push('/login');_context.next=12;break;case 5:comment={content:content.current.value,rating:cacheIdx+cacheRating};formData={article:props.article,comment:comment,author:props.article.author};resetComment();console.log(formData);_context.next=11;return props.onSubmit(formData);case 11:props.onHandle();case 12:case\"end\":return _context.stop();}}},_callee);}));return function submit(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{class:\"control-group\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group controls\",children:[/*#__PURE__*/_jsx(\"textarea\",{class:\"form-control\",cols:\"50\",rows:\"3\",ref:content,placeholder:\"Comment\"}),/*#__PURE__*/_jsx(\"p\",{class:\"help-block text-danger\"})]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return submit();},class:\"btn btn-primary\",id:\"sendMessageButton\",children:\"Comment\"}),/*#__PURE__*/_jsx(Star,{_mouseOver:_mouseOver,onChange:handleChange,idx:idx,rating:rating,cacheIdx:cacheIdx,cacheRating:cacheRating})]})]});};export default withRouter(CommentForm);","map":{"version":3,"sources":["/mnt/c/Users/82107/Desktop/study/3-2/웹시설/프로젝트/Dream_Search/frontend/src/components/CommentForm.js"],"names":["React","useRef","useState","Star","withRouter","CommentForm","props","idx","setIdx","rating","setRating","cacheIdx","setCacheIdx","cacheRating","setCacheRating","content","_mouseOver","e","i","persist","offsetX","nativeEvent","clientX","target","clientWidth","value","handleChange","v","resetComment","current","submit","window","sessionStorage","getItem","alert","history","push","comment","formData","article","author","console","log","onSubmit","onHandle"],"mappings":"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","sourcesContent":["import React, { useRef, useState } from 'react'\r\nimport Star from './Star'\r\nimport {withRouter} from 'react-router-dom'\r\n\r\nconst CommentForm = (props) => {\r\n    const [idx, setIdx] = useState(0);\r\n    const [rating, setRating] = useState(0);\r\n    const [cacheIdx, setCacheIdx] = useState(0);\r\n    const [cacheRating, setCacheRating] = useState(0);\r\n\r\n    const content = useRef();\r\n\r\n    const _mouseOver = (e, i) => {\r\n        e.persist()\r\n        let offsetX = e.nativeEvent.offsetX;\r\n        let clientX = e.target.clientWidth;\r\n\r\n        if (offsetX > clientX / 2) {\r\n            let value = 2;\r\n            setIdx(i);\r\n            setRating(value);\r\n        } else {\r\n            let value = 1;\r\n            setIdx(i);\r\n            setRating(value);\r\n        }\r\n    }\r\n\r\n    const handleChange = (i, v) => {\r\n        setIdx(0);\r\n        setRating(0);\r\n        setCacheIdx(i);\r\n        setCacheRating(v);\r\n    }\r\n\r\n    const resetComment = () => {\r\n        setCacheIdx(0);\r\n        setCacheRating(0);\r\n        content.current.value = '';\r\n    }\r\n\r\n    const submit = async () => {\r\n        if (!window.sessionStorage.getItem('n_name')) {\r\n            window.alert('로그인이 필요합니다!');\r\n            props.history.push('/login');\r\n        }\r\n        else {\r\n            const comment = {\r\n                content: content.current.value,\r\n                rating: cacheIdx + cacheRating\r\n            }\r\n            const formData = {\r\n                article: props.article,\r\n                comment: comment,\r\n                author: props.article.author\r\n            }\r\n            resetComment();\r\n            console.log(formData);\r\n            await props.onSubmit(formData);\r\n            props.onHandle();\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div class=\"control-group\">\r\n            <div class=\"form-group controls\">\r\n                <textarea class=\"form-control\" cols=\"50\" rows=\"3\" ref={content} placeholder=\"Comment\" />\r\n                <p class=\"help-block text-danger\"></p>\r\n            </div>\r\n            <span>\r\n                <button onClick={() => submit()} class=\"btn btn-primary\" id=\"sendMessageButton\">Comment</button>\r\n                <Star\r\n                    _mouseOver={_mouseOver}\r\n                    onChange={handleChange}\r\n                    idx={idx}\r\n                    rating={rating}\r\n                    cacheIdx={cacheIdx}\r\n                    cacheRating={cacheRating} />\r\n            </span>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default withRouter(CommentForm);"]},"metadata":{},"sourceType":"module"}